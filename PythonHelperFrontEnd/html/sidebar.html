<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI助手侧边栏</title>
    <link rel="stylesheet" href="../css/sidebar.css">
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
</head>
<body>

    <div class="sidebar-container">
        <div class="sidebar-column">
            <div class="sidebar-icons">
                <div class="icon-group top">
                    <button id="toggleChatListBtn" title="切换对话列表">
                        <span class="material-symbols-outlined">menu</span>
                    </button>
                    <button id="newChatBtn" title="新对话">
                        <span class="material-symbols-outlined">add</span>
                    </button>
                </div>
                <div class="icon-group bottom">
                    <button id="ptaBtn" title="PTA题目分析">
                        <span class="material-symbols-outlined">analytics</span>
                    </button>
                    <button id="mistakesBtn" title="错题集">
                        <img src="../icons/MistakeSet.png" alt="Python课程AI教学助手" class="mistakeset-btn">
                    </button>
                    <button id="settingsBtn" title="设置">
                        <span class="material-symbols-outlined">settings</span>
                    </button>
                </div>
            </div>

            <nav id="sidebarNav" class="sidebar-nav">
                <div class="chat-list-header">
                    <h4>对话列表</h4>
                </div>
                <div id="chatList" class="chat-list"></div>
            </nav>
        </div>

        <main id="mainContent" class="main-content">
            <div id="welcomeScreen" class="view">
                <div class="welcome-content">
                    <span class="welcome-icon material-symbols-outlined">auto_awesome</span>
                    <h2>Python课程AI助教</h2>
                    <p>开始你的第一次对话，解决你的编程难题。</p>
                    <button id="startFirstChat" class="start-chat-btn">开始对话</button>
                </div>
            </div>

            <div id="chatInterface" class="view hidden">
                <header class="sidebar-header">
                    <h1 id="currentChatTitle">新对话</h1>
                    <div class="header-actions-right">
                        <button id="memoryManageBtn" class="header-action-btn" title="记忆管理">
                            <span class="material-symbols-outlined">psychology</span>
                        </button>
                        <button id="enterMistakeModeBtn" class="header-action-btn" title="保存错题记录">
                            <span class="material-symbols-outlined">bookmark_add</span>
                        </button>
                        <button id="clearChatBtn" class="header-action-btn" title="清空对话">
                            <span class="material-symbols-outlined">delete_sweep</span>
                        </button>
                    </div>
                </header>
                <div id="chatMessages" class="chat-container"></div>
                <footer class="sidebar-footer">
                    <div class="footer-actions">
                        <button id="saveSelectionBtn" class="save-selection-btn hidden">
                            <span class="material-symbols-outlined">save</span>
                            保存选中消息为错题
                        </button>
                    </div>
                    <form class="input-form">
                        <textarea id="chatInput" placeholder="输入你的问题...(选中文字会粘贴到这)" rows="1"></textarea>
                        <button id="sendMessage" type="submit" class="send-btn">
                            <span class="material-symbols-outlined">arrow_upward</span>
                        </button>
                    </form>
                </footer>
            </div>
            
            <div id="mistakeCollection" class="view hidden">
                <header class="sidebar-header">
                    <button id="backToMain" class="header-action-btn" title="返回">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1>错题集</h1>
                    <button id="openMistakeManagerBtn" class="header-action-btn header-action-right" title="管理错题集">
                        <span class="material-symbols-outlined">open_in_new</span>
                    </button>
                </header>
                <div id="mistakeListContainer" class="mistake-list-container"></div>
            </div>

            <div id="settingsInterface" class="view hidden">
                 <header class="sidebar-header">
                    <button id="backToMainFromSettings" class="header-action-btn" title="返回">
                        <span class="material-symbols-outlined">arrow_back</span>
                    </button>
                    <h1>设置</h1>
                </header>
                <div class="settings-container">
                    <div class="form-group">
                        <label for="aiApiKey">API Key</label>
                        <input type="password" id="aiApiKey" placeholder="请输入你的API Key">
                    </div>
                    <div class="form-group">
                        <label for="aiApiEndpoint">API Endpoint</label>
                        <input type="text" id="aiApiEndpoint">
                    </div>
                    <div class="form-group">
                        <label for="questionMode">问题模式</label>
                        <select id="questionMode">
                            <option value="objective">教学助手 (选择/判断题)</option>
                            <option value="function">函数编程助手</option>
                            <option value="programming">完整编程助手</option>
                        </select>
                    </div>
                    <button id="saveSettings" class="save-settings-btn">保存设置</button>
                </div>
            </div>

            <div id="ptaAnalysisInterface" class="view hidden">
                <header class="sidebar-header">
                   <button id="backToMainFromPta" class="header-action-btn" title="返回">
                       <span class="material-symbols-outlined">arrow_back</span>
                   </button>
                   <h1>PTA题目分析</h1>
               </header>
               <div class="settings-container"> 
                   <div class="form-group">
                       <label for="ptaUrlInput">PTA题目集网址</label>
                       <input type="text" id="ptaUrlInput" placeholder="粘贴拼题A的题目集网址...">
                   </div>
                   <button id="startPtaAnalysisBtn" class="save-settings-btn">开始分析</button>
               </div>
           </div>

        </main>
    </div>

    <script type="module" src="../js/sidebar/SidebarManager.js"></script>
</body>
</html>